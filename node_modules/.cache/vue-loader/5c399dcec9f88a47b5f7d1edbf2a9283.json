{"remainingRequest":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Login/index.vue","mtime":1587473580947},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gInV1aWQiOwppbXBvcnQgeyBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7CmltcG9ydCB1c2VyQXBpIGZyb20gImFwaS91c2VyIjsKaW1wb3J0IHsKICB2YWxpZGF0ZVBhc3N3b3JkLAogIHZhbGlkYXRlRW1haWwsCiAgdmFsaWRhdGVOYW1lCn0gZnJvbSAiY29tbW9uL3V0aWxzL3ZhbGlkYXRlUnVsZXMiOwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIG1vZGU6IHsKICAgICAgZGVmYXVsdDogImxvZ2luIgogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJlbWVtYmVyOiBmYWxzZSwKICAgICAgZm9ybURhdGE6IHsKICAgICAgICB1c2VyRmlyc3ROYW1lOiAiIiwKICAgICAgICB1c2VyTGFzdE5hbWU6ICIiLAogICAgICAgIHVzZXJFbWFpbDogIiIsCiAgICAgICAgdXNlclBhc3N3b3JkOiAiIgogICAgICB9LAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgZm9ybVJ1bGVzOiB7CiAgICAgICAgdXNlckZpcnN0TmFtZTogWwogICAgICAgICAgewogICAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlTmFtZSwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICB1c2VyTGFzdE5hbWU6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZU5hbWUsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgdXNlckVtYWlsOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwiLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVFbWFpbCwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICB1c2VyUGFzc3dvcmQ6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBwYXNzd29yZCIsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3N3b3JkLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0sCiAgICAgIGZvcm1MYWJlbFdpZHRoOiAiMTAwcHgiCiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIG9uU3VibWl0Q2xpY2soKSB7CiAgICAgIHRoaXMuJHJlZnMuZWRpdExvZ2luRm9ybS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB1c2VyQXBpLmxvZ2luKHRoaXMuZm9ybURhdGEpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgbWVzc2FnZTogIkxvZ2luIFN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5zZXRVc2VyKHJlcy51c2VyKTsKICAgICAgICAgICAgICB0aGlzLmdldE9yZGVySGlzdG9yeShyZXMudXNlci51c2VySWQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuZm9ybURhdGEgPSB7CiAgICAgICAgICAgICAgICB1c2VyRW1haWw6ICIiLAogICAgICAgICAgICAgICAgdXNlclBhc3N3b3JkOiAiIgogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIG9uUmVnaXN0ZXJDbGljaygpIHsKICAgICAgdGhpcy4kcmVmcy5lZGl0TG9naW5Gb3JtLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHRoaXMuZm9ybURhdGEudXNlcklkID0gdXVpZHY0KCk7CiAgICAgICAgICB1c2VyQXBpLmFkZFVzZXIodGhpcy5mb3JtRGF0YSkudGhlbihyZXMgPT4gewogICAgICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiUmVnaXN0ZXIgU3VjY2VzcyIsCiAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgLi4ubWFwQWN0aW9ucyhbInNldFVzZXIiLCAiZ2V0T3JkZXJIaXN0b3J5Il0pCiAgfQp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Login","sourcesContent":["<template>\n  <el-dialog\n    class=\"ap-dialog\"\n    :title=\"mode == 'login' ? 'Log In' : 'Register'\"\n    :visible.sync=\"dialogVisible\"\n    width=\"1100px\"\n  >\n    <div class=\"dialog-inner\">\n      <el-form\n        :model=\"formData\"\n        :rules=\"formRules\"\n        ref=\"editLoginForm\"\n      >\n        <template v-if=\"mode == 'login'\">\n          <!-- Name -->\n          <el-form-item\n            label=\"Email\"\n            :label-width=\"formLabelWidth\"\n            prop=\"userEmail\"\n          >\n            <el-input\n              v-model=\"formData.userEmail\"\n              placeholder=\"Please enter email\"\n            ></el-input>\n          </el-form-item>\n\n          <!-- Password -->\n          <el-form-item\n            label=\"Password\"\n            :label-width=\"formLabelWidth\"\n            prop=\"userPassword\"\n          >\n            <el-input\n              v-model=\"formData.userPassword\"\n              show-password\n              placeholder=\"Please enter password\"\n            ></el-input>\n          </el-form-item>\n        </template>\n        <template v-else>\n          <!-- Name -->\n          <el-form-item\n            label=\"First Name\"\n            :label-width=\"formLabelWidth\"\n            prop=\"userFirstName\"\n          >\n            <el-input\n              v-model=\"formData.userFirstName\"\n              placeholder=\"Please enter first name\"\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item\n            label=\"Last Name\"\n            :label-width=\"formLabelWidth\"\n            prop=\"userLastName\"\n          >\n            <el-input\n              v-model=\"formData.userLastName\"\n              placeholder=\"Please enter last name\"\n            ></el-input>\n          </el-form-item>\n\n          <!-- Email -->\n          <el-form-item\n            label=\"Email\"\n            :label-width=\"formLabelWidth\"\n            prop=\"userEmail\"\n          >\n            <el-input\n              v-model=\"formData.userEmail\"\n              placeholder=\"Please enter email\"\n            ></el-input>\n          </el-form-item>\n\n          <!-- Password -->\n          <el-form-item\n            label=\"Password\"\n            :label-width=\"formLabelWidth\"\n            prop=\"userPassword\"\n          >\n            <el-input\n              v-model=\"formData.userPassword\"\n              show-password\n              placeholder=\"Please enter password\"\n            ></el-input>\n          </el-form-item>\n        </template>\n      </el-form>\n    </div>\n\n    <div\n      slot=\"footer\"\n      class=\"dialog-footer\"\n    >\n      <el-button @click=\"dialogVisible = false\">Cancel</el-button>\n      <el-button\n        v-if=\"mode == 'login'\"\n        type=\"primary\"\n        @click=\"onSubmitClick\"\n      >Log In</el-button>\n      <el-button\n        v-else\n        type=\"primary\"\n        @click=\"onRegisterClick\"\n      >Register</el-button>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport { v4 as uuidv4 } from \"uuid\";\nimport { mapActions } from \"vuex\";\nimport userApi from \"api/user\";\nimport {\n  validatePassword,\n  validateEmail,\n  validateName\n} from \"common/utils/validateRules\";\nexport default {\n  props: {\n    mode: {\n      default: \"login\"\n    }\n  },\n  data() {\n    return {\n      remember: false,\n      formData: {\n        userFirstName: \"\",\n        userLastName: \"\",\n        userEmail: \"\",\n        userPassword: \"\"\n      },\n      dialogVisible: false,\n      formRules: {\n        userFirstName: [\n          {\n            validator: validateName,\n            trigger: \"blur\"\n          }\n        ],\n        userLastName: [\n          {\n            validator: validateName,\n            trigger: \"blur\"\n          }\n        ],\n        userEmail: [\n          {\n            required: true,\n            message: \"Please enter a valid email\",\n            trigger: \"blur\"\n          },\n          {\n            validator: validateEmail,\n            trigger: \"blur\"\n          }\n        ],\n        userPassword: [\n          {\n            required: true,\n            message: \"Please enter a valid password\",\n            trigger: \"blur\"\n          },\n          {\n            validator: validatePassword,\n            trigger: \"blur\"\n          }\n        ]\n      },\n      formLabelWidth: \"100px\"\n    };\n  },\n\n  methods: {\n    onSubmitClick() {\n      this.$refs.editLoginForm.validate(valid => {\n        if (valid) {\n          userApi.login(this.formData).then(res => {\n            this.dialogVisible = false;\n            if (res.success) {\n              this.$message({\n                type: \"success\",\n                message: \"Login Success\",\n                showClose: true\n              });\n              this.setUser(res.user);\n              this.getOrderHistory(res.user.userId);\n            } else {\n              this.formData = {\n                userEmail: \"\",\n                userPassword: \"\"\n              };\n            }\n          });\n        }\n      });\n    },\n\n    onRegisterClick() {\n      this.$refs.editLoginForm.validate(valid => {\n        if (valid) {\n          this.formData.userId = uuidv4();\n          userApi.addUser(this.formData).then(res => {\n            this.dialogVisible = false;\n            if (res.success) {\n              this.$message({\n                type: \"success\",\n                message: \"Register Success\",\n                showClose: true\n              });\n            }\n          });\n        }\n      });\n    },\n\n    ...mapActions([\"setUser\", \"getOrderHistory\"])\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.ap-dialog {\n  overflow-x: visible;\n  .dialog-inner {\n    max-height: 60vh;\n    overflow-x: visible;\n    overflow-y: auto;\n    padding: 0 20px;\n  }\n\n  .form-item-right {\n    display: flex;\n    justify-content: flex-end;\n  }\n}\n</style>\n"]}]}