{"remainingRequest":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Manage/AddProductDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Manage/AddProductDialog.vue","mtime":1586117841337},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAidXVpZCI7CmltcG9ydCB7IHVwbG9hZEltYWdlIH0gZnJvbSAiYXBpL2NvbW1vbiI7CmltcG9ydCBwcm9kdWN0Q29uZmlnIGZyb20gIi4vY29uZmlnL3Byb2R1Y3RfY29uZmlnLmpzIjsKaW1wb3J0IHByb2R1Y3RBcGkgZnJvbSAiYXBpL3Byb2R1Y3QiOwppbXBvcnQgVGV4dEVkaXRvciBmcm9tICJjb21wb25lbnRzL1RleHRFZGl0b3IiOwppbXBvcnQgeyBjaGVja0RvdWJsZSB9IGZyb20gImNvbW1vbi91dGlscy92YWxpZGF0ZVJ1bGVzIjsKaW1wb3J0IHsgZWRpdFByb2R1Y3RGb3JtIGFzIHRlc3RGb3JtRGF0YSB9IGZyb20gImNvbW1vbi9jb25maWcvdGVzdERhdGEiOwoKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBtb2RlOiB7CiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgfSwKICAgIHRhcmdldFByb2R1Y3Q6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9LAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0ZXN0Rm9ybURhdGEsCiAgICAgIGFjdGl2ZVRhYk5hbWU6ICIxIiwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGZvcm1EYXRhOiB7CiAgICAgICAgcHJvZHVjdE5hbWU6ICIiLAogICAgICAgIHByb2R1Y3REZXNjOiAiIiwKICAgICAgICBwcm9kdWN0U3BlY3M6ICIiLAogICAgICAgIHByb2R1Y3RXYXJyYW50eTogIiIsCiAgICAgICAgcHJvZHVjdFZpZGVvOiAiIiwKICAgICAgICBwcm9kdWN0RmVhdHVyZXM6ICIiLAogICAgICAgIHByb2R1Y3RQcmljZTogIiIsCiAgICAgICAgcHJvZHVjdENhdGVnb3J5OiBbXSwKICAgICAgICBwcm9kdWN0QXBwbGljYXRpb246IFtdLAogICAgICAgIHByb2R1Y3RQYXJhbWV0ZXI6IFtdLAogICAgICAgIHByb2R1Y3RJbWFnZUxpc3Q6IFtdLAogICAgICB9LAogICAgICBmb3JtUnVsZXM6IHsKICAgICAgICBwcm9kdWN0TmFtZTogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBlbnRlciBhIHZhbGlkIG5hbWUiLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgcHJvZHVjdFByaWNlOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgcHJpY2UiLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB2YWxpZGF0b3I6IGNoZWNrRG91YmxlKCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBudW1iZXIgd2l0aCB0d28gZGVjaW1hbCBwbGFjZXMiKSwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9LAogICAgICBmb3JtTGFiZWxXaWR0aDogIjEwMHB4IiwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGNhdGVnb3J5TGlzdEJ5UHJvZHVjdCgpIHsKICAgICAgY29uc3QgcmVzdWx0ID0gW107CiAgICAgIHRoaXMuY2F0ZWdvcnlMaXN0LmZvckVhY2goKGNhdGVnb3J5KSA9PiB7CiAgICAgICAgaWYgKGNhdGVnb3J5LmNhdGVnb3J5VHlwZSA9PSAiUHJvZHVjdCIpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKHsKICAgICAgICAgICAgbGFiZWw6IGNhdGVnb3J5LmNhdGVnb3J5TmFtZSwKICAgICAgICAgICAgdmFsdWU6IGNhdGVnb3J5LmNhdGVnb3J5SWQsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIGNhdGVnb3J5TGlzdEJ5QXBwbGljYXRpb24oKSB7CiAgICAgIGNvbnN0IHJlc3VsdCA9IFtdOwogICAgICB0aGlzLmNhdGVnb3J5TGlzdC5mb3JFYWNoKChjYXRlZ29yeSkgPT4gewogICAgICAgIGlmIChjYXRlZ29yeS5jYXRlZ29yeVR5cGUgPT0gIkFwcGxpY2F0aW9ucyIpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKHsKICAgICAgICAgICAgbGFiZWw6IGNhdGVnb3J5LmNhdGVnb3J5TmFtZSwKICAgICAgICAgICAgdmFsdWU6IGNhdGVnb3J5LmNhdGVnb3J5SWQsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIGNhdGVnb3J5TGlzdEJ5UGFyYW10ZXIoKSB7CiAgICAgIGNvbnN0IHJlc3VsdCA9IFtdOwogICAgICB0aGlzLmNhdGVnb3J5TGlzdC5mb3JFYWNoKChjYXRlZ29yeSkgPT4gewogICAgICAgIGlmIChjYXRlZ29yeS5jYXRlZ29yeVR5cGUgPT0gIlBhcmFtZXRlcnMiKSB7CiAgICAgICAgICByZXN1bHQucHVzaCh7CiAgICAgICAgICAgIGxhYmVsOiBjYXRlZ29yeS5jYXRlZ29yeU5hbWUsCiAgICAgICAgICAgIHZhbHVlOiBjYXRlZ29yeS5jYXRlZ29yeUlkLAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICAuLi5tYXBHZXR0ZXJzKFsiY2F0ZWdvcnlMaXN0Il0pLAogIH0sCgogIHdhdGNoOiB7CiAgICB0YXJnZXRQcm9kdWN0KHByb2R1Y3QpIHsKICAgICAgaWYgKHByb2R1Y3QpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZm9ybURhdGEsIHByb2R1Y3QpOwogICAgICB9CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIG9uU3VibWl0Q2xpY2soKSB7CiAgICAgIHRoaXMuJHJlZnMuZWRpdFByb2R1Y3RGb3JtLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdGhpcy5mb3JtRGF0YS5wcm9kdWN0SW1hZ2VzID0gSlNPTi5zdHJpbmdpZnkodGhpcy5mb3JtRGF0YS5wcm9kdWN0SW1hZ2VMaXN0KTsKICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT09IHByb2R1Y3RDb25maWcuTU9ERS5ORVcpIHsKICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gdXVpZHY0KCk7CiAgICAgICAgICAgIHRoaXMuZm9ybURhdGEucHJvZHVjdElkID0gcHJvZHVjdElkOwoKICAgICAgICAgICAgcHJvZHVjdEFwaS5hZGRQcm9kdWN0KHRoaXMuZm9ybURhdGEpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuZ2V0UHJvZHVjdExpc3QoKTsKICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJBZGQgUHJvZHVjdCBTdWNjZXNzIiwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gcHJvZHVjdENvbmZpZy5NT0RFLkVESVQpIHsKICAgICAgICAgICAgcHJvZHVjdEFwaS51cGRhdGVQcm9kdWN0KHRoaXMuZm9ybURhdGEpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuZ2V0UHJvZHVjdExpc3QoKTsKICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVcGRhdGUgUHJvZHVjdCBTdWNjZXNzIiwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgb25VcGxvYWRJbWFnZShyZXEpIHsKICAgICAgbGV0IGZpbGV0eXBlID0gIiI7CiAgICAgIGlmIChyZXEuZmlsZS50eXBlID09PSAiaW1hZ2UvcG5nIikgewogICAgICAgIGZpbGV0eXBlID0gInBuZyI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmlsZXR5cGUgPSAianBnIjsKICAgICAgfQoKICAgICAgLy8g6YeN5ZG95ZCN6KaB5LiK5Lyg55qE5paH5Lu2CiAgICAgIGNvbnN0IGZpbGVuYW1lID0gdXVpZHY0KCkgKyAiLiIgKyBmaWxldHlwZTsKCiAgICAgIGNvbnN0IGZvcm1kYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICBmb3JtZGF0YS5hcHBlbmQoImZpbGUiLCByZXEuZmlsZSk7CgogICAgICB1cGxvYWRJbWFnZSgKICAgICAgICBmaWxlbmFtZSwKICAgICAgICBmb3JtZGF0YSwKICAgICAgICB7CiAgICAgICAgICBoZWFkZXJzOiB7ICJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YSIgfSwKICAgICAgICB9LAogICAgICAgIChpbWFnZSkgPT4gewogICAgICAgICAgdGhpcy5mb3JtRGF0YS5wcm9kdWN0SW1hZ2VMaXN0LnB1c2goaW1hZ2UpOwogICAgICAgIH0KICAgICAgKTsKICAgIH0sCgogICAgLy8g6aqM6K+B5paH5Lu25ZCI5rOV5oCnCiAgICBiZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICBjb25zdCBpc0pQRyA9IGZpbGUudHlwZSA9PT0gImltYWdlL2pwZWciIHx8IGZpbGUudHlwZSA9PT0gImltYWdlL3BuZyI7CiAgICAgIGNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgNTsKCiAgICAgIGlmICghaXNKUEcpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCJJbWFnZSB0eXBlIHNob3VsZCBiZSBKUEVEIG9yIFBORyIpOwogICAgICB9CgogICAgICBpZiAoIWlzTHQyTSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIkltYWdlIHNpemUgc2hvdWxkIGxlc3MgdGhhbiA1TUIiKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlzSlBHICYmIGlzTHQyTTsKICAgIH0sCgogICAgb25VcGxvYWRTdWNjZXNzKCkge30sCgogICAgb25JbWFnZVJlbW92ZSh0YXJnZXQpIHsKICAgICAgbGV0IHRhcmdldEluZGV4ID0gbnVsbDsKICAgICAgdGhpcy5mb3JtRGF0YS5wcm9kdWN0SW1hZ2VMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gdGFyZ2V0Lm5hbWUpIHsKICAgICAgICAgIHRhcmdldEluZGV4ID0gaW5kZXg7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICh0YXJnZXRJbmRleCAhPT0gbnVsbCkgewogICAgICAgIHRoaXMuZm9ybURhdGEucHJvZHVjdEltYWdlTGlzdC5zcGxpY2UodGFyZ2V0SW5kZXgsIDEpOwogICAgICB9CiAgICB9LAoKICAgIC4uLm1hcEFjdGlvbnMoWyJnZXRQcm9kdWN0TGlzdCJdKSwKICB9LAoKICBjb21wb25lbnRzOiB7CiAgICAiYXAtdGV4dGVkaXRvciI6IFRleHRFZGl0b3IsCiAgfSwKfTsK"},{"version":3,"sources":["AddProductDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"AddProductDialog.vue","sourceRoot":"src/views/Manage","sourcesContent":["<template>\n  <el-dialog class=\"ap-dialog\" title=\"Edit Product\" :visible.sync=\"dialogVisible\" width=\"1100px\">\n    <el-form :model=\"formData\" :rules=\"formRules\" ref=\"editProductForm\">\n      <!-- Name -->\n      <el-form-item label=\"Name\" :label-width=\"formLabelWidth\" prop=\"productName\">\n        <el-input v-model=\"formData.productName\"></el-input>\n      </el-form-item>\n\n      <!-- Price -->\n      <el-form-item label=\"Price\" :label-width=\"formLabelWidth\" prop=\"productPrice\">\n        <el-input v-model=\"formData.productPrice\"></el-input>\n      </el-form-item>\n\n      <!-- Parameter -->\n      <el-form-item label=\"Parameter\" :label-width=\"formLabelWidth\" prop=\"productParameter\">\n        <el-select class=\"form-item\" v-model=\"formData.productParameter\" filterable multiple>\n          <el-option\n            v-for=\"item in categoryListByParamter\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n\n      <!-- Category -->\n      <el-form-item label=\"Product\" :label-width=\"formLabelWidth\" prop=\"productCategory\">\n        <el-select class=\"form-item\" v-model=\"formData.productCategory\" filterable multiple>\n          <el-option\n            v-for=\"item in categoryListByProduct\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n\n      <!-- Application -->\n      <el-form-item label=\"Application\" :label-width=\"formLabelWidth\" prop=\"productApplication\">\n        <el-select class=\"form-item\" v-model=\"formData.productApplication\" filterable multiple>\n          <el-option\n            v-for=\"item in categoryListByApplication\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n    </el-form>\n\n    <!-- Pictures -->\n    <el-upload\n      class=\"dialog-picture-upload\"\n      action=\"\"\n      :http-request=\"onUploadImage\"\n      :before-upload=\"beforeUpload\"\n      :on-success=\"onUploadSuccess\"\n      :on-remove=\"onImageRemove\"\n      :file-list=\"formData.productImageList\"\n      list-type=\"picture-card\"\n    >\n      <i class=\"el-icon-plus\"></i>\n    </el-upload>\n\n    <!-- Rich Text Enter -->\n    <el-tabs class=\"dialog-tabs\" v-model=\"activeTabName\">\n      <!-- Description -->\n      <el-tab-pane label=\"Description\" name=\"1\">\n        <ap-texteditor v-model=\"formData.productDesc\" />\n      </el-tab-pane>\n\n      <!-- Feature -->\n      <el-tab-pane label=\"Feature\" name=\"2\">\n        <ap-texteditor v-model=\"formData.productFeatures\" />\n      </el-tab-pane>\n\n      <!-- Speces -->\n      <el-tab-pane label=\"Specs\" name=\"3\">\n        <ap-texteditor v-model=\"formData.productSpecs\" />\n      </el-tab-pane>\n\n      <!-- Video -->\n      <el-tab-pane label=\"Video\" name=\"4\">\n        <ap-texteditor v-model=\"formData.productVideo\" />\n      </el-tab-pane>\n\n      <!-- Warrant -->\n      <el-tab-pane label=\"Warrant\" name=\"5\">\n        <ap-texteditor v-model=\"formData.productWarranty\" />\n      </el-tab-pane>\n    </el-tabs>\n    <div slot=\"footer\" class=\"dialog-footer\">\n      <el-button @click=\"dialogVisible = false\">Cancel</el-button>\n      <el-button type=\"primary\" @click=\"onSubmitClick\">Submit</el-button>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from \"vuex\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { uploadImage } from \"api/common\";\nimport productConfig from \"./config/product_config.js\";\nimport productApi from \"api/product\";\nimport TextEditor from \"components/TextEditor\";\nimport { checkDouble } from \"common/utils/validateRules\";\nimport { editProductForm as testFormData } from \"common/config/testData\";\n\nexport default {\n  props: {\n    mode: {\n      required: true,\n    },\n    targetProduct: {\n      type: Object,\n      default() {\n        return null;\n      },\n    },\n  },\n  data() {\n    return {\n      testFormData,\n      activeTabName: \"1\",\n      dialogVisible: false,\n      formData: {\n        productName: \"\",\n        productDesc: \"\",\n        productSpecs: \"\",\n        productWarranty: \"\",\n        productVideo: \"\",\n        productFeatures: \"\",\n        productPrice: \"\",\n        productCategory: [],\n        productApplication: [],\n        productParameter: [],\n        productImageList: [],\n      },\n      formRules: {\n        productName: [\n          {\n            required: true,\n            message: \"Please enter a valid name\",\n            trigger: \"blur\",\n          },\n        ],\n        productPrice: [\n          {\n            required: true,\n            message: \"Please enter a valid price\",\n            trigger: \"blur\",\n          },\n          {\n            validator: checkDouble(\"Please enter a valid number with two decimal places\"),\n            trigger: \"blur\",\n          },\n        ],\n      },\n      formLabelWidth: \"100px\",\n    };\n  },\n\n  computed: {\n    categoryListByProduct() {\n      const result = [];\n      this.categoryList.forEach((category) => {\n        if (category.categoryType == \"Product\") {\n          result.push({\n            label: category.categoryName,\n            value: category.categoryId,\n          });\n        }\n      });\n      return result;\n    },\n    categoryListByApplication() {\n      const result = [];\n      this.categoryList.forEach((category) => {\n        if (category.categoryType == \"Applications\") {\n          result.push({\n            label: category.categoryName,\n            value: category.categoryId,\n          });\n        }\n      });\n      return result;\n    },\n    categoryListByParamter() {\n      const result = [];\n      this.categoryList.forEach((category) => {\n        if (category.categoryType == \"Parameters\") {\n          result.push({\n            label: category.categoryName,\n            value: category.categoryId,\n          });\n        }\n      });\n      return result;\n    },\n    ...mapGetters([\"categoryList\"]),\n  },\n\n  watch: {\n    targetProduct(product) {\n      if (product) {\n        Object.assign(this.formData, product);\n      }\n    },\n  },\n\n  methods: {\n    onSubmitClick() {\n      this.$refs.editProductForm.validate((valid) => {\n        if (valid) {\n          this.formData.productImages = JSON.stringify(this.formData.productImageList);\n          if (this.mode === productConfig.MODE.NEW) {\n            const productId = uuidv4();\n            this.formData.productId = productId;\n\n            productApi.addProduct(this.formData).then((res) => {\n              this.dialogVisible = false;\n              this.getProductList();\n              if (res.success) {\n                this.$message({\n                  type: \"success\",\n                  message: \"Add Product Success\",\n                });\n              }\n            });\n          } else if (this.mode === productConfig.MODE.EDIT) {\n            productApi.updateProduct(this.formData).then((res) => {\n              this.dialogVisible = false;\n              this.getProductList();\n              if (res.success) {\n                this.$message({\n                  type: \"success\",\n                  message: \"Update Product Success\",\n                });\n              }\n            });\n          }\n        }\n      });\n    },\n\n    onUploadImage(req) {\n      let filetype = \"\";\n      if (req.file.type === \"image/png\") {\n        filetype = \"png\";\n      } else {\n        filetype = \"jpg\";\n      }\n\n      // 重命名要上传的文件\n      const filename = uuidv4() + \".\" + filetype;\n\n      const formdata = new FormData();\n\n      formdata.append(\"file\", req.file);\n\n      uploadImage(\n        filename,\n        formdata,\n        {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n        },\n        (image) => {\n          this.formData.productImageList.push(image);\n        }\n      );\n    },\n\n    // 验证文件合法性\n    beforeUpload(file) {\n      const isJPG = file.type === \"image/jpeg\" || file.type === \"image/png\";\n      const isLt2M = file.size / 1024 / 1024 < 5;\n\n      if (!isJPG) {\n        this.$message.error(\"Image type should be JPED or PNG\");\n      }\n\n      if (!isLt2M) {\n        this.$message.error(\"Image size should less than 5MB\");\n      }\n\n      return isJPG && isLt2M;\n    },\n\n    onUploadSuccess() {},\n\n    onImageRemove(target) {\n      let targetIndex = null;\n      this.formData.productImageList.forEach((item, index) => {\n        if (item.name === target.name) {\n          targetIndex = index;\n        }\n      });\n\n      if (targetIndex !== null) {\n        this.formData.productImageList.splice(targetIndex, 1);\n      }\n    },\n\n    ...mapActions([\"getProductList\"]),\n  },\n\n  components: {\n    \"ap-texteditor\": TextEditor,\n  },\n};\n</script>\n\n<style lang=\"less\">\n.ap-dialog {\n  .dialog-picture-upload {\n    width: 100%;\n    display: flex;\n    justify-content: flex-start;\n    margin: 10px 0;\n  }\n\n  .form-item {\n    width: 100%;\n  }\n}\n</style>\n"]}]}