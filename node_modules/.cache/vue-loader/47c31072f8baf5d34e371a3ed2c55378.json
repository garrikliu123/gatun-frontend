{"remainingRequest":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Account/myInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Account/myInfo.vue","mtime":1587332616173},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHVzZXJBcGkgZnJvbSAiYXBpL3VzZXIiOwppbXBvcnQgeyB2YWxpZGF0ZVBhc3N3b3JkLCB2YWxpZGF0ZUVtYWlsLCB2YWxpZGF0ZU5hbWUgfSBmcm9tICJjb21tb24vdXRpbHMvdmFsaWRhdGVSdWxlcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2hhbmdlUGFzc3dvcmQ6IGZhbHNlLAogICAgICBmb3JtRGF0YTogewogICAgICAgIHVzZXJGaXJzdE5hbWU6ICIiLAogICAgICAgIHVzZXJMYXN0TmFtZTogIiIsCiAgICAgICAgdXNlckVtYWlsOiAiIiwKICAgICAgICBjdXJyZW50UGFzc3dvcmQ6ICIiLAogICAgICAgIG5ld1Bhc3N3b3JkOiAiIiwKICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICIiCiAgICAgIH0sCgogICAgICBmb3JtUnVsZXM6IHsKICAgICAgICB1c2VyRmlyc3ROYW1lOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVOYW1lLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIHVzZXJMYXN0TmFtZTogWwogICAgICAgICAgewogICAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlTmFtZSwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICB1c2VyRW1haWw6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCIsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZUVtYWlsLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIGN1cnJlbnRQYXNzd29yZDogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBlbnRlciBhIHZhbGlkIHBhc3N3b3JkIiwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzc3dvcmQsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgbmV3UGFzc3dvcmQ6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBwYXNzd29yZCIsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3N3b3JkLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIGNvbmZpcm1QYXNzd29yZDogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBlbnRlciBhIHZhbGlkIHBhc3N3b3JkIiwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzc3dvcmQsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdmFsaWRhdG9yOiB0aGlzLnZhbGlkYXRlQ29uZmlybVBhc3N3b3JkLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0sCiAgICAgIGZvcm1MYWJlbFdpZHRoOiAiMjAwcHgiCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsidXNlciJdKQogIH0sCgogIHdhdGNoOiB7CiAgICB1c2VyOiB7CiAgICAgIGltbWVkaWF0ZTogdHJ1ZSwKICAgICAgaGFuZGxlcih1c2VyKSB7CiAgICAgICAgaWYgKHVzZXIgJiYgdXNlci51c2VyRW1haWwpIHsKICAgICAgICAgIHRoaXMuZm9ybURhdGEudXNlcklkID0gdXNlci51c2VySWQ7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnVzZXJGaXJzdE5hbWUgPSB1c2VyLnVzZXJGaXJzdG5hbWU7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnVzZXJMYXN0TmFtZSA9IHVzZXIudXNlckxhc3RuYW1lOwogICAgICAgICAgdGhpcy5mb3JtRGF0YS51c2VyRW1haWwgPSB1c2VyLnVzZXJFbWFpbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBvblNhdmVFZGl0KCkgewogICAgICB0aGlzLiRyZWZzLmVkaXRJbmZvRm9ybS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAoIXRoaXMuY2hhbmdlUGFzc3dvcmQpIHsKICAgICAgICAgICAgdXNlckFwaQogICAgICAgICAgICAgIC51cGRhdGVVc2VyKHsKICAgICAgICAgICAgICAgIHVzZXJJZDogdGhpcy5mb3JtRGF0YS51c2VySWQsCiAgICAgICAgICAgICAgICB1c2VyRW1haWw6IHRoaXMuZm9ybURhdGEudXNlckVtYWlsLAogICAgICAgICAgICAgICAgdXNlckZpcnN0bmFtZTogdGhpcy5mb3JtRGF0YS51c2VyRmlyc3ROYW1lLAogICAgICAgICAgICAgICAgdXNlckxhc3RuYW1lOiB0aGlzLmZvcm1EYXRhLnVzZXJMYXN0TmFtZQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIkVkaXQgQWNjb3VudCBJbmZvIFN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHVzZXJBcGkKICAgICAgICAgICAgICAubG9naW4oewogICAgICAgICAgICAgICAgdXNlckVtYWlsOiB0aGlzLmZvcm1EYXRhLnVzZXJFbWFpbCwKICAgICAgICAgICAgICAgIHVzZXJQYXNzd29yZDogdGhpcy5mb3JtRGF0YS5jdXJyZW50UGFzc3dvcmQKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgdXNlckFwaQogICAgICAgICAgICAgICAgICAgIC51cGRhdGVVc2VyKHsKICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdGhpcy5mb3JtRGF0YS51c2VySWQsCiAgICAgICAgICAgICAgICAgICAgICB1c2VyRW1haWw6IHRoaXMuZm9ybURhdGEudXNlckVtYWlsLAogICAgICAgICAgICAgICAgICAgICAgdXNlclBhc3N3b3JkOiB0aGlzLmZvcm1EYXRhLm5ld1Bhc3N3b3JkCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCJob21lIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiRWRpdCBBY2NvdW50IEluZm8gU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8qIOmqjOivgeWvhueggSAqLwogICAgdmFsaWRhdGVDb25maXJtUGFzc3dvcmQocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSB7CiAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5mb3JtRGF0YS5uZXdQYXNzd29yZCkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soIkNvbmZpcm1lZCBQYXNzd29yZCBkb2VzIG5vdCBtYXRjaCBuZXcgcGFzc3dvcmQuIik7CiAgICAgIH0KICAgIH0sCgogICAgLi4ubWFwQWN0aW9ucyhbImxvZ291dCJdKQogIH0KfTsK"},{"version":3,"sources":["myInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"myInfo.vue","sourceRoot":"src/views/Account","sourcesContent":["<template>\n  <div class=\"my-info\">\n    <div class=\"edit-info-form\">\n      <h2>Edit Account Information</h2>\n      <el-form class=\"account-form\" :model=\"formData\" :rules=\"formRules\" ref=\"editInfoForm\">\n        <!-- Name -->\n        <el-form-item label=\"First Name\" :label-width=\"formLabelWidth\" prop=\"userFirstName\">\n          <el-input\n            v-model=\"formData.userFirstName\"\n            placeholder=\"Please enter first name\"\n          ></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"Last Name\" :label-width=\"formLabelWidth\" prop=\"userLastName\">\n          <el-input v-model=\"formData.userLastName\" placeholder=\"Please enter last name\"></el-input>\n        </el-form-item>\n\n        <!-- Email -->\n        <el-form-item label=\"Email\" :label-width=\"formLabelWidth\" prop=\"userEmail\">\n          <el-input\n            :disabled=\"true\"\n            v-model=\"formData.userEmail\"\n            placeholder=\"Please enter email\"\n          ></el-input>\n        </el-form-item>\n\n        <el-form-item class=\"change-password-item\" label=\"\" :label-width=\"formLabelWidth\">\n          <el-checkbox\n            v-model=\"changePassword\"\n            label=\"Change Password\"\n            border\n            size=\"medium\"\n          ></el-checkbox>\n        </el-form-item>\n\n        <template v-if=\"changePassword\">\n          <!-- Password -->\n          <el-form-item\n            label=\"Current Password\"\n            :label-width=\"formLabelWidth\"\n            prop=\"currentPassword\"\n          >\n            <el-input\n              v-model=\"formData.currentPassword\"\n              show-password\n              placeholder=\"Please enter password\"\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"New Password\" :label-width=\"formLabelWidth\" prop=\"newPassword\">\n            <el-input\n              v-model=\"formData.newPassword\"\n              show-password\n              placeholder=\"Please enter password\"\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item\n            label=\"Confirm New Password\"\n            :label-width=\"formLabelWidth\"\n            prop=\"confirmPassword\"\n          >\n            <el-input\n              v-model=\"formData.confirmPassword\"\n              show-password\n              placeholder=\"Please enter password\"\n            ></el-input>\n          </el-form-item>\n        </template>\n\n        <el-form-item class=\"form-item-button\">\n          <el-popconfirm\n            title=\"Do you want to save the edit?\"\n            @onConfirm=\"onSaveEdit\"\n            confirmButtonText=\"Yes\"\n            cancelButtonText=\"Cancel\"\n          >\n            <el-button slot=\"reference\" type=\"primary\">Save Edit</el-button>\n          </el-popconfirm>\n        </el-form-item>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from \"vuex\";\nimport userApi from \"api/user\";\nimport { validatePassword, validateEmail, validateName } from \"common/utils/validateRules\";\nexport default {\n  data() {\n    return {\n      changePassword: false,\n      formData: {\n        userFirstName: \"\",\n        userLastName: \"\",\n        userEmail: \"\",\n        currentPassword: \"\",\n        newPassword: \"\",\n        confirmPassword: \"\"\n      },\n\n      formRules: {\n        userFirstName: [\n          {\n            validator: validateName,\n            trigger: \"blur\"\n          }\n        ],\n        userLastName: [\n          {\n            validator: validateName,\n            trigger: \"blur\"\n          }\n        ],\n        userEmail: [\n          {\n            required: true,\n            message: \"Please enter a valid email\",\n            trigger: \"blur\"\n          },\n          {\n            validator: validateEmail,\n            trigger: \"blur\"\n          }\n        ],\n        currentPassword: [\n          {\n            required: true,\n            message: \"Please enter a valid password\",\n            trigger: \"blur\"\n          },\n          {\n            validator: validatePassword,\n            trigger: \"blur\"\n          }\n        ],\n        newPassword: [\n          {\n            required: true,\n            message: \"Please enter a valid password\",\n            trigger: \"blur\"\n          },\n          {\n            validator: validatePassword,\n            trigger: \"blur\"\n          }\n        ],\n        confirmPassword: [\n          {\n            required: true,\n            message: \"Please enter a valid password\",\n            trigger: \"blur\"\n          },\n          {\n            validator: validatePassword,\n            trigger: \"blur\"\n          },\n          {\n            validator: this.validateConfirmPassword,\n            trigger: \"blur\"\n          }\n        ]\n      },\n      formLabelWidth: \"200px\"\n    };\n  },\n\n  computed: {\n    ...mapGetters([\"user\"])\n  },\n\n  watch: {\n    user: {\n      immediate: true,\n      handler(user) {\n        if (user && user.userEmail) {\n          this.formData.userId = user.userId;\n          this.formData.userFirstName = user.userFirstname;\n          this.formData.userLastName = user.userLastname;\n          this.formData.userEmail = user.userEmail;\n        }\n      }\n    }\n  },\n\n  methods: {\n    onSaveEdit() {\n      this.$refs.editInfoForm.validate(valid => {\n        if (valid) {\n          if (!this.changePassword) {\n            userApi\n              .updateUser({\n                userId: this.formData.userId,\n                userEmail: this.formData.userEmail,\n                userFirstname: this.formData.userFirstName,\n                userLastname: this.formData.userLastName\n              })\n              .then(res => {\n                if (res.success) {\n                  this.$message({\n                    type: \"success\",\n                    message: \"Edit Account Info Success\",\n                    showClose: true\n                  });\n                }\n              });\n          } else {\n            userApi\n              .login({\n                userEmail: this.formData.userEmail,\n                userPassword: this.formData.currentPassword\n              })\n              .then(res => {\n                if (res.success) {\n                  userApi\n                    .updateUser({\n                      userId: this.formData.userId,\n                      userEmail: this.formData.userEmail,\n                      userPassword: this.formData.newPassword\n                    })\n                    .then(res => {\n                      if (res.success) {\n                        this.logout();\n                        this.$router.push(\"home\");\n                        this.$message({\n                          type: \"success\",\n                          message: \"Edit Account Info Success\",\n                          showClose: true\n                        });\n                      }\n                    });\n                }\n              });\n          }\n        }\n      });\n    },\n\n    /* 验证密码 */\n    validateConfirmPassword(rule, value, callback) {\n      if (value === this.formData.newPassword) {\n        callback();\n      } else {\n        callback(\"Confirmed Password does not match new password.\");\n      }\n    },\n\n    ...mapActions([\"logout\"])\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.my-info {\n  display: flex;\n\n  h2 {\n    margin-top: 0;\n  }\n\n  .change-password-item {\n    display: flex;\n    justify-content: flex-start;\n\n    margin-top: 40px;\n  }\n\n  .edit-info-form {\n    flex: 1 1 auto;\n  }\n\n  .account-form {\n    margin-right: 100px;\n  }\n\n  .form-item-button {\n    display: flex;\n    justify-content: flex-end;\n  }\n}\n</style>\n"]}]}