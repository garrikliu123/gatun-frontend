{"remainingRequest":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Manage/AddHomeSectionDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/src/views/Manage/AddHomeSectionDialog.vue","mtime":1587272613798},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xiangliu/Development/Projects/xxx/apera-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gInV1aWQiOwppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7CmltcG9ydCB7IHVwbG9hZEltYWdlIH0gZnJvbSAiYXBpL2NvbW1vbiI7CmltcG9ydCBzZWN0aW9uQ29uZmlnIGZyb20gIi4vY29uZmlnL3NlY3Rpb25fY29uZmlnLmpzIjsKaW1wb3J0IHNlY3Rpb25UYWJsZUNvbmZpZyBmcm9tICIuL2NvbmZpZy9zZWN0aW9uX3RhYmxlX2NvbmZpZy5qcyI7CmltcG9ydCBob21lU2VjdGlvbkFwaSBmcm9tICJhcGkvaG9tZVNlY3Rpb24uanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIG1vZGU6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICB0YXJnZXRTZWN0aW9uOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgc2VjdGlvblRhYmxlQ29uZmlnLAogICAgICBmb3JtRGF0YTogewogICAgICAgIHNlY3Rpb25OYW1lOiAiIiwKICAgICAgICBzZWN0aW9uVHlwZTogc2VjdGlvblRhYmxlQ29uZmlnLnNlY3Rpb25UeXBlT3B0aW9uc1swXS52YWx1ZSwKICAgICAgICB0b3BpY1R5cGU6IHNlY3Rpb25UYWJsZUNvbmZpZy50eXBlT3B0aW9uc1swXS52YWx1ZSwKICAgICAgICBzZWN0aW9uSW1hZ2U6ICIiLAogICAgICAgIHNlY3Rpb25Db250ZW50VHlwZTogMSwKICAgICAgICBjYXRlZ29yeUxpc3Q6IFtdLAogICAgICAgIHByb2R1Y3Q6IG51bGwsCiAgICAgICAgcHJvZHVjdExpc3Q6IFtdCiAgICAgIH0sCiAgICAgIGZvcm1SdWxlczogewogICAgICAgIHNlY3Rpb25OYW1lOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgbmFtZSIsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgcHJvZHVjdDogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBzZWxlY3QgYSBwcm9kdWN0IiwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBwcm9kdWN0TGlzdDogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBzZWxlY3QgYSBwcm9kdWN0IiwKICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBjYXRlZ29yeUxpc3Q6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICJQbGVhc2Ugc2VsZWN0IGEgY2F0ZWdvcnkiLAogICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0sCiAgICAgIGZvcm1MYWJlbFdpZHRoOiAiMTAwcHgiCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBtYXRjaGVkQ2F0ZWdvcnlMaXN0KCkgewogICAgICBjb25zdCByZXN1bHQgPSBbXTsKICAgICAgdGhpcy5jYXRlZ29yeUxpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICBpZiAoaXRlbS5jYXRlZ29yeVR5cGUgPT09IHRoaXMuZm9ybURhdGEudG9waWNUeXBlKSB7CiAgICAgICAgICByZXN1bHQucHVzaCh7CiAgICAgICAgICAgIGxhYmVsOiBpdGVtLmNhdGVnb3J5TmFtZSwKICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY2F0ZWdvcnlJZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCgogICAgbWF0Y2hlZFByb2R1Y3RMaXN0KCkgewogICAgICBjb25zdCByZXN1bHQgPSBbXTsKICAgICAgdGhpcy5wcm9kdWN0TGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIHJlc3VsdC5wdXNoKHsKICAgICAgICAgIGxhYmVsOiBpdGVtLnByb2R1Y3ROYW1lLAogICAgICAgICAgdmFsdWU6IGl0ZW0ucHJvZHVjdElkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKCiAgICAuLi5tYXBHZXR0ZXJzKFsiY2F0ZWdvcnlMaXN0IiwgInByb2R1Y3RMaXN0Il0pCiAgfSwKCiAgd2F0Y2g6IHsKICAgIHRhcmdldFNlY3Rpb24oc2VjdGlvbikgewogICAgICBpZiAoc2VjdGlvbikgewogICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5mb3JtRGF0YSwgc2VjdGlvbik7CiAgICAgIH0KICAgIH0sCiAgICAiZm9ybURhdGEuc2VjdGlvblR5cGUiOiB7CiAgICAgIGltbWVkaWF0ZTogdHJ1ZSwKICAgICAgaGFuZGxlcih0eXBlKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gIlByb2R1Y3RTZWN0aW9uIikgewogICAgICAgICAgdGhpcy5mb3JtRGF0YS5zZWN0aW9uQ29udGVudFR5cGUgPSAyOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAiZm9ybURhdGEudG9waWNUeXBlIigpIHsKICAgICAgdGhpcy5mb3JtRGF0YS5jYXRlZ29yeUxpc3QgPSBbXTsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBvblN1Ym1pdENsaWNrKCkgewogICAgICB0aGlzLiRyZWZzLmVkaXRTZWN0aW9uRm9ybS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAodGhpcy5tb2RlID09PSBzZWN0aW9uQ29uZmlnLk1PREUuTkVXKSB7CiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25JZCA9IHV1aWR2NCgpOwoKICAgICAgICAgICAgY29uc3Qgb2JqID0gewogICAgICAgICAgICAgIHNlY3Rpb25JZDogc2VjdGlvbklkLAogICAgICAgICAgICAgIHNlY3Rpb25EYXRhOiBKU09OLnN0cmluZ2lmeSh0aGlzLmZvcm1EYXRhKQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaG9tZVNlY3Rpb25BcGkuYWRkU2VjdGlvbihvYmopLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLmdldEhvbWVTZWN0aW9uTGlzdCgpOwogICAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIkFkZCBTZWN0aW9uIFN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PT0gc2VjdGlvbkNvbmZpZy5NT0RFLkVESVQpIHsKICAgICAgICAgICAgY29uc3Qgb2JqID0gewogICAgICAgICAgICAgIHNlY3Rpb25JZDogdGhpcy5mb3JtRGF0YS5zZWN0aW9uSWQsCiAgICAgICAgICAgICAgc2VjdGlvbkRhdGE6IEpTT04uc3RyaW5naWZ5KHRoaXMuZm9ybURhdGEpCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBob21lU2VjdGlvbkFwaS51cGRhdGVTZWN0aW9uKG9iaikudGhlbihyZXMgPT4gewogICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuZ2V0SG9tZVNlY3Rpb25MaXN0KCk7CiAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVXBkYXRlIFNlY3Rpb24gU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBvblVwbG9hZEltYWdlKHJlcSkgewogICAgICBsZXQgZmlsZXR5cGUgPSAiIjsKICAgICAgaWYgKHJlcS5maWxlLnR5cGUgPT09ICJpbWFnZS9wbmciKSB7CiAgICAgICAgZmlsZXR5cGUgPSAicG5nIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWxldHlwZSA9ICJqcGciOwogICAgICB9CgogICAgICAvLyDph43lkb3lkI3opoHkuIrkvKDnmoTmlofku7YKICAgICAgY29uc3QgZmlsZW5hbWUgPSB1dWlkdjQoKSArICIuIiArIGZpbGV0eXBlOwoKICAgICAgY29uc3QgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKTsKCiAgICAgIGZvcm1kYXRhLmFwcGVuZCgiZmlsZSIsIHJlcS5maWxlKTsKCiAgICAgIHVwbG9hZEltYWdlKAogICAgICAgIGZpbGVuYW1lLAogICAgICAgIGZvcm1kYXRhLAogICAgICAgIHsKICAgICAgICAgIGhlYWRlcnM6IHsgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIiB9CiAgICAgICAgfSwKICAgICAgICBpbWFnZSA9PiB7CiAgICAgICAgICBpZiAoaW1hZ2UudXJsKSB7CiAgICAgICAgICAgIHRoaXMuZm9ybURhdGEuc2VjdGlvbkltYWdlID0gaW1hZ2UudXJsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKTsKICAgIH0sCgogICAgLy8g6aqM6K+B5paH5Lu25ZCI5rOV5oCnCiAgICBiZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICBjb25zdCBpc0pQRyA9IGZpbGUudHlwZSA9PT0gImltYWdlL2pwZWciIHx8IGZpbGUudHlwZSA9PT0gImltYWdlL3BuZyI7CiAgICAgIGNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgNTsKCiAgICAgIGlmICghaXNKUEcpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCJJbWFnZSB0eXBlIHNob3VsZCBiZSBKUEVEIG9yIFBORyIpOwogICAgICB9CgogICAgICBpZiAoIWlzTHQyTSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIkltYWdlIHNpemUgc2hvdWxkIGxlc3MgdGhhbiA1TUIiKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlzSlBHICYmIGlzTHQyTTsKICAgIH0sCgogICAgb25VcGxvYWRTdWNjZXNzKCkge30sCgogICAgLi4ubWFwQWN0aW9ucyhbImdldEhvbWVTZWN0aW9uTGlzdCJdKQogIH0KfTsK"},{"version":3,"sources":["AddHomeSectionDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA","file":"AddHomeSectionDialog.vue","sourceRoot":"src/views/Manage","sourcesContent":["<template>\n  <div>\n    <el-dialog class=\"ap-dialog\" title=\"Edit Section\" :visible.sync=\"dialogVisible\" width=\"1100px\">\n      <div class=\"dialog-inner\">\n        <el-form :model=\"formData\" :rules=\"formRules\" ref=\"editSectionForm\">\n          <el-form-item label=\"Name\" :label-width=\"formLabelWidth\" prop=\"sectionName\">\n            <el-input v-model=\"formData.sectionName\"></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"Section Type\" :label-width=\"formLabelWidth\">\n            <el-select\n              class=\"form-item\"\n              v-model=\"formData.sectionType\"\n              placeholder=\"Select the type\"\n            >\n              <el-option\n                v-for=\"item in sectionTableConfig.sectionTypeOptions\"\n                :key=\"item.value\"\n                :label=\"item.label\"\n                :value=\"item.value\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n\n          <el-form-item class=\"form-radio-group\" :label-width=\"formLabelWidth\">\n            <el-radio-group v-model=\"formData.sectionContentType\">\n              <el-radio-button :label=\"1\" :disabled=\"formData.sectionType == 'ProductSection'\"\n                >Single Product</el-radio-button\n              >\n              <el-radio-button :label=\"2\">Product Group</el-radio-button>\n              <el-radio-button :label=\"3\" :disabled=\"formData.sectionType == 'ProductSection'\"\n                >Topic</el-radio-button\n              >\n            </el-radio-group>\n          </el-form-item>\n\n          <!-- Product -->\n          <el-form-item\n            v-if=\"formData.sectionContentType != 3 && formData.sectionContentType == 1\"\n            label=\"Product\"\n            :label-width=\"formLabelWidth\"\n            prop=\"product\"\n          >\n            <el-select\n              key=\"product\"\n              class=\"form-item\"\n              v-model=\"formData.product\"\n              filterable\n              placeholder=\"Please select a product\"\n            >\n              <el-option\n                v-for=\"item in matchedProductList\"\n                :key=\"item.value\"\n                :label=\"item.label\"\n                :value=\"item.value\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n\n          <!-- Product -->\n          <el-form-item\n            v-if=\"formData.sectionContentType != 3 && formData.sectionContentType == 2\"\n            label=\"Product\"\n            :label-width=\"formLabelWidth\"\n            prop=\"productList\"\n          >\n            <el-select\n              key=\"productList\"\n              class=\"form-item\"\n              v-model=\"formData.productList\"\n              filterable\n              placeholder=\"Please select a product\"\n              multiple\n            >\n              <el-option\n                v-for=\"item in matchedProductList\"\n                :key=\"item.value\"\n                :label=\"item.label\"\n                :value=\"item.value\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n\n          <!-- TOPIC -->\n          <el-form-item\n            v-if=\"formData.sectionContentType == 3\"\n            label=\"Topic Type\"\n            :label-width=\"formLabelWidth\"\n          >\n            <el-select\n              key=\"topicType\"\n              class=\"form-item\"\n              v-model=\"formData.topicType\"\n              placeholder=\"Select the type\"\n            >\n              <el-option\n                v-for=\"item in sectionTableConfig.typeOptions\"\n                :key=\"item.value\"\n                :label=\"item.label\"\n                :value=\"item.value\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n\n          <el-form-item\n            v-if=\"formData.sectionContentType == 3\"\n            label=\"Category\"\n            :label-width=\"formLabelWidth\"\n            prop=\"categoryList\"\n          >\n            <el-select\n              key=\"categoryList\"\n              class=\"form-item\"\n              v-model=\"formData.categoryList\"\n              filterable\n              multiple\n            >\n              <el-option\n                v-for=\"item in matchedCategoryList\"\n                :key=\"item.value\"\n                :label=\"item.label\"\n                :value=\"item.value\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n\n          <!-- IMAGE -->\n          <el-upload\n            v-if=\"formData.sectionType != 'ProductSection'\"\n            class=\"avatar-uploader\"\n            action=\"\"\n            :show-file-list=\"false\"\n            :http-request=\"onUploadImage\"\n            :before-upload=\"beforeUpload\"\n            :on-success=\"onUploadSuccess\"\n          >\n            <img v-if=\"formData.sectionImage\" :src=\"formData.sectionImage\" class=\"avatar\" />\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n          </el-upload>\n        </el-form>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"onSubmitClick\">Submit</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { v4 as uuidv4 } from \"uuid\";\nimport { mapGetters, mapActions } from \"vuex\";\nimport { uploadImage } from \"api/common\";\nimport sectionConfig from \"./config/section_config.js\";\nimport sectionTableConfig from \"./config/section_table_config.js\";\nimport homeSectionApi from \"api/homeSection.js\";\nexport default {\n  props: {\n    mode: {\n      required: true\n    },\n    targetSection: {\n      type: Object,\n      default() {\n        return null;\n      }\n    }\n  },\n\n  data() {\n    return {\n      dialogVisible: false,\n      sectionTableConfig,\n      formData: {\n        sectionName: \"\",\n        sectionType: sectionTableConfig.sectionTypeOptions[0].value,\n        topicType: sectionTableConfig.typeOptions[0].value,\n        sectionImage: \"\",\n        sectionContentType: 1,\n        categoryList: [],\n        product: null,\n        productList: []\n      },\n      formRules: {\n        sectionName: [\n          {\n            required: true,\n            message: \"Please enter a valid name\",\n            trigger: \"blur\"\n          }\n        ],\n        product: [\n          {\n            required: true,\n            message: \"Please select a product\",\n            trigger: \"blur\"\n          }\n        ],\n        productList: [\n          {\n            required: true,\n            message: \"Please select a product\",\n            trigger: \"blur\"\n          }\n        ],\n        categoryList: [\n          {\n            required: true,\n            message: \"Please select a category\",\n            trigger: \"blur\"\n          }\n        ]\n      },\n      formLabelWidth: \"100px\"\n    };\n  },\n\n  computed: {\n    matchedCategoryList() {\n      const result = [];\n      this.categoryList.forEach(item => {\n        if (item.categoryType === this.formData.topicType) {\n          result.push({\n            label: item.categoryName,\n            value: item.categoryId\n          });\n        }\n      });\n      return result;\n    },\n\n    matchedProductList() {\n      const result = [];\n      this.productList.forEach(item => {\n        result.push({\n          label: item.productName,\n          value: item.productId\n        });\n      });\n      return result;\n    },\n\n    ...mapGetters([\"categoryList\", \"productList\"])\n  },\n\n  watch: {\n    targetSection(section) {\n      if (section) {\n        Object.assign(this.formData, section);\n      }\n    },\n    \"formData.sectionType\": {\n      immediate: true,\n      handler(type) {\n        if (type == \"ProductSection\") {\n          this.formData.sectionContentType = 2;\n        }\n      }\n    },\n\n    \"formData.topicType\"() {\n      this.formData.categoryList = [];\n    }\n  },\n\n  methods: {\n    onSubmitClick() {\n      this.$refs.editSectionForm.validate(valid => {\n        if (valid) {\n          if (this.mode === sectionConfig.MODE.NEW) {\n            const sectionId = uuidv4();\n\n            const obj = {\n              sectionId: sectionId,\n              sectionData: JSON.stringify(this.formData)\n            };\n\n            homeSectionApi.addSection(obj).then(res => {\n              this.dialogVisible = false;\n              this.getHomeSectionList();\n              if (res.success) {\n                this.$message({\n                  type: \"success\",\n                  message: \"Add Section Success\",\n                  showClose: true\n                });\n              }\n            });\n          } else if (this.mode === sectionConfig.MODE.EDIT) {\n            const obj = {\n              sectionId: this.formData.sectionId,\n              sectionData: JSON.stringify(this.formData)\n            };\n\n            homeSectionApi.updateSection(obj).then(res => {\n              this.dialogVisible = false;\n              this.getHomeSectionList();\n              if (res.success) {\n                this.$message({\n                  type: \"success\",\n                  message: \"Update Section Success\",\n                  showClose: true\n                });\n              }\n            });\n          }\n        }\n      });\n    },\n\n    onUploadImage(req) {\n      let filetype = \"\";\n      if (req.file.type === \"image/png\") {\n        filetype = \"png\";\n      } else {\n        filetype = \"jpg\";\n      }\n\n      // 重命名要上传的文件\n      const filename = uuidv4() + \".\" + filetype;\n\n      const formdata = new FormData();\n\n      formdata.append(\"file\", req.file);\n\n      uploadImage(\n        filename,\n        formdata,\n        {\n          headers: { \"Content-Type\": \"multipart/form-data\" }\n        },\n        image => {\n          if (image.url) {\n            this.formData.sectionImage = image.url;\n          }\n        }\n      );\n    },\n\n    // 验证文件合法性\n    beforeUpload(file) {\n      const isJPG = file.type === \"image/jpeg\" || file.type === \"image/png\";\n      const isLt2M = file.size / 1024 / 1024 < 5;\n\n      if (!isJPG) {\n        this.$message.error(\"Image type should be JPED or PNG\");\n      }\n\n      if (!isLt2M) {\n        this.$message.error(\"Image size should less than 5MB\");\n      }\n\n      return isJPG && isLt2M;\n    },\n\n    onUploadSuccess() {},\n\n    ...mapActions([\"getHomeSectionList\"])\n  }\n};\n</script>\n\n<style lang=\"less\">\n.ap-dialog {\n  overflow-x: visible;\n  .dialog-inner {\n    max-height: 60vh;\n    overflow-x: visible;\n    overflow-y: auto;\n    padding: 0 20px;\n  }\n\n  .form-radio-group {\n    display: flex;\n    justify-content: flex-start;\n  }\n\n  .form-item {\n    width: 100%;\n  }\n\n  .avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n  .avatar-uploader .el-upload:hover {\n    border-color: #409eff;\n  }\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 400px;\n    height: 180px;\n    line-height: 178px;\n    text-align: center;\n  }\n  .avatar {\n    height: 180px;\n    display: block;\n  }\n}\n</style>\n"]}]}